%% Credential Cache Flow
sequenceDiagram
    participant User
    participant UI as Login/Setup UI
    participant Preload
    participant Main
    participant CredentialSvc as CredentialService
    participant SteamSvc as SteamService
    participant SecureStore as OS Keychain

    User->>UI: Submit Steam credentials / Guard code
    UI->>Preload: electronAPI.credentialCache.save()
    Preload->>Main: IPC credential-cache-save
    Main->>CredentialSvc: Encrypt & persist
    CredentialSvc->>SecureStore: Store encrypted blob
    SecureStore-->>CredentialSvc: Persisted
    CredentialSvc-->>Main: Success
    Main-->>Preload: IPC ack
    Preload-->>UI: Save confirmed

    Note over Main,SteamSvc: Later download requires auth
    SteamSvc->>CredentialSvc: Retrieve cached credentials
    CredentialSvc->>SecureStore: Load & decrypt
    SecureStore-->>CredentialSvc: Decrypted credentials
    CredentialSvc-->>SteamSvc: Credentials
    SteamSvc->>DepotSvc: Continue download
