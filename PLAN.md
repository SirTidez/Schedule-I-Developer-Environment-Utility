Lets start by creating the integration layer between steamcmd and our application. We first need to have the user login to their steam account. We need to ensure that they have steam closed on their system first before attempting a login since each Steam account can only be logged in to one place
at one time. Once we have validated that steamcmd is properly installed, lets run steamcmd to make sure its initialized. Present the user with a login page for username and password with promting that explains that they will get a notice from steamguard the first time they login. Allow the user to select if they want to stay logged in or not. If they do, store their login details in an encrypted sha512 file in the same directory as the config file. Explain to the user how their data will be handled if it is cached. Then, pass the login details to steamcmd by using login <username> <password>
after entering the steamcmd shell env. Check the output for "Logging in user '{user}' [U:1:0] to Steam Public...This account is protected by a Steam Guard mobile authenticator.
Please confirm the login in the Steam Mobile app on your phone." to see if they need to confirm with steamguard. We are waiting for "Waiting for confirmation...OK
Waiting for client config...OK
Waiting for user info...OK" to signal that we have successfully logged in. If we have, we actually want to close out of the shell env and run one more command that we can change per-branch to handle the downloading. All we need to send to get each branch downloaded is the following: "steamcmd +force_install_dir {branch-dir} +login <username> <password> +app_update {sched1-app-id} -beta {branch-id} +quit". We only want to download the branches that we don't currently have installed, so lets copy the installed branch first. Then using the above command, lets download each additional selected branches.